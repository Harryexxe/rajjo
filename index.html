<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>To My Rajjo üíï‚ú®</title>

<link href="https://fonts.googleapis.com/css2?family=Gloria+Hallelujah&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">

<style>

/* --- BIRTHDAY ABSTRACT BACKGROUND --- */
.birthday-bg {
    z-index: 2;
    overflow: hidden;
}

.bday-shape {
    position: absolute;
    opacity: 0.25;
    animation: bdayFloat linear infinite;
    pointer-events: none;
}

.bday-shape svg {
    width: 100%;
    height: 100%;
    stroke-width: 3;
    fill: none;
}

/* Ribbon-like curves */
.bday-ribbon svg path {
    stroke: var(--accent-pink);
}

/* Balloon outlines */
.bday-balloon svg ellipse {
    stroke: var(--accent-purple);
}

/* Celebration spark lines */
.bday-spark svg line {
    stroke: var(--accent-teal);
}

/* Motion */
@keyframes bdayFloat {
    from {
        transform: translateY(110vh) rotate(0deg);
    }
    to {
        transform: translateY(-120vh) rotate(360deg);
    }
}

.feedback-text {
    text-align: center;
    margin-left: auto;
    margin-right: auto;
}

/* --- CORE VARIABLES --- */
:root {
    --bg-color: #f4f8fb;
    --paper-color: #fffef8;
    --ink-color: #2d3436;
    --accent-pink: #ff7675;
    --accent-yellow: #ffeaa7;
    --accent-teal: #74b9ff;
    --accent-purple: #a29bfe;
    --accent-green: #55efc4;
    --accent-orange: #fab1a0;
    
    --border-thick: 3px solid var(--ink-color);
    --shadow-hard: 8px 8px 0px var(--ink-color);
}

/* --- RESET & BASE --- */
* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color: transparent; }

body {
    min-height: 100vh;
    background-color: var(--bg-color);
    font-family: 'Quicksand', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden; 
    color: var(--ink-color);
    cursor: none; 
}

/* --- SVG FILTERS --- */
.svg-filters { position: absolute; width: 0; height: 0; pointer-events: none; }

/* --- CUSTOM CURSOR --- */
#cursor-dot, #cursor-glow {
    position: fixed;
    top: 0; left: 0;
    transform: translate(-50%, -50%);
    pointer-events: none;
    z-index: 9999;
}

#cursor-dot {
    width: 12px; height: 12px;
    background: var(--ink-color);
    border-radius: 50%;
}

#cursor-glow {
    width: 60px; height: 60px;
    background: rgba(255, 118, 117, 0.4);
    border-radius: 50%;
    filter: blur(5px);
    transition: width 0.3s, height 0.3s, background 0.3s;
}

body.is-clicking #cursor-dot { transform: translate(-50%, -50%) scale(0.8); }
body.is-clicking #cursor-glow { width: 50px; height: 50px; background: rgba(116, 185, 255, 0.6); }

/* --- BACKGROUNDS --- */
.bg-layer { position: fixed; inset: 0; pointer-events: none; }

.paper-grain {
    z-index: 10;
    opacity: 0.5;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.1'/%3E%3C/svg%3E");
}

/* NEW: Background Tracking Grid */
.bg-grid {
    z-index: 1;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 0;
    opacity: 0.15;
}

.grid-item {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100px;
}

.grid-arrow {
    width: 15px;
    height: 15px;
    border-right: 3px solid var(--ink-color);
    border-bottom: 3px solid var(--ink-color);
    transform: rotate(45deg);
    transition: transform 0.1s;
}

/* Floating Shapes */
.shape {
    position: absolute;
    opacity: 0.6;
    animation: float var(--duration, 10s) ease-in-out infinite;
    z-index: 2;
}
.shape svg { width: 100%; height: 100%; fill: none; stroke: var(--color, var(--ink-color)); stroke-width: 3; stroke-linecap: round; }

@keyframes float {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    50% { transform: translate(var(--mx, 20px), var(--my, -20px)) rotate(var(--mr, 10deg)); }
}

/* --- MAIN CARD --- */
.card-wrapper {
    position: relative;
    width: 90%;
    max-width: 650px;
    perspective: 1000px;
    z-index: 100;
}

.card {
    background: var(--paper-color);
    border: var(--border-thick);
    border-radius: 12px;
    padding: 2rem;
    position: relative;
    box-shadow: var(--shadow-hard);
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    filter: url(#wavy); 
    display: none;
    flex-direction: column;
    align-items: center;
    text-align: center;
    max-height: 90vh;
    overflow-y: auto;
}

.card.active { display: flex; animation: cardEnter 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
.card.exit { animation: cardExit 0.6s cubic-bezier(0.36, 0, 0.66, -0.56) forwards; }

@keyframes cardEnter {
    from { opacity: 0; transform: translateY(100px) rotate(-5deg) scale(0.9); }
    to { opacity: 1; transform: translateY(0) rotate(0deg) scale(1); }
}
@keyframes cardExit {
    to { opacity: 0; transform: translateY(-100px) rotate(10deg) scale(0.9); }
}

/* --- THE WATCHER (Googly Eyes) --- */
.watcher {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 200;
}
.eye {
    width: 50px; height: 50px;
    background: white;
    border: 3px solid var(--ink-color);
    border-radius: 50%;
    position: relative;
    box-shadow: 4px 4px 0 rgba(0,0,0,0.1);
}
.pupil {
    width: 18px; height: 18px;
    background: var(--ink-color);
    border-radius: 50%;
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
}

/* --- TYPOGRAPHY --- */
h1 {
    font-family: 'Gloria Hallelujah', cursive;
    font-size: clamp(2rem, 5vw, 3.5rem);
    line-height: 1.2;
    margin-bottom: 1.5rem;
    color: var(--ink-color);
    text-shadow: 3px 3px 0 var(--accent-pink);
}

.highlight {
    background: linear-gradient(120deg, transparent 0%, transparent 40%, var(--accent-yellow) 40%, var(--accent-yellow) 100%);
    padding: 0 5px;
}

/* --- COUNTDOWN --- */
.countdown-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    margin: 2rem 0;
    width: 100%;
}

.time-box {
    background: white;
    border: 3px solid var(--ink-color);
    padding: 15px 5px;
    border-radius: 8px;
    box-shadow: 4px 4px 0 var(--accent-teal);
}
.time-box span {
    display: block;
    font-family: 'Gloria Hallelujah', cursive;
    font-size: 2.2rem;
    font-weight: bold;
}

/* --- BUTTONS --- */
.btn-quirky {
    font-family: 'Gloria Hallelujah', cursive;
    font-size: 1.2rem;
    padding: 1rem 3rem;
    background: var(--accent-purple);
    color: white;
    border: 3px solid var(--ink-color);
    border-radius: 50px;
    cursor: none;
    box-shadow: 6px 6px 0 var(--ink-color);
    transition: transform 0.1s, box-shadow 0.1s;
    margin-top: 20px;
    position: relative;
    user-select: none;
}
.btn-quirky:hover { transform: translate(-2px, -2px); box-shadow: 8px 8px 0 var(--ink-color); }
.btn-quirky:active { transform: translate(4px, 4px) scale(0.95); box-shadow: 2px 2px 0 var(--ink-color); }

/* --- DISABLED / SHAKE ANIMATION --- */
.btn-quirky.disabled { 
    opacity: 0.6; 
    filter: grayscale(1);
    cursor: not-allowed; /* Shows the "no" cursor */
    /* IMPORTANT: pointer-events must be AUTO so we can detect the click to trigger shake */
    pointer-events: auto; 
}

/* The "NO" Shake Animation */
@keyframes shake-deny {
    0%, 100% { transform: translateX(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-6px) rotate(-3deg); }
    20%, 40%, 60%, 80% { transform: translateX(6px) rotate(3deg); }
}

.shake-anim {
    animation: shake-deny 0.5s cubic-bezier(.36,.07,.19,.97) both;
}

/* --- QUIZ --- */
.progress-track {
    width: 100%;
    height: 16px; /* Slightly taller */
    border: 2px solid var(--ink-color);
    border-radius: 10px;
    background: #fff;
    margin-bottom: 2rem;
    overflow: hidden;
    position: relative;
    box-shadow: 2px 2px 0 rgba(0,0,0,0.05) inset;
}
.progress-fill {
    height: 100%;
    /* Added striped animation for visibility */
    background: repeating-linear-gradient(
        45deg, 
        var(--accent-pink), 
        var(--accent-pink) 10px, 
        var(--accent-orange) 10px, 
        var(--accent-orange) 20px
    );
    width: 0%;
    transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    background-size: 28px 28px; /* For animation */
    animation: barberpole 1s linear infinite;
}

@keyframes barberpole {
    0% { background-position: 0 0; }
    100% { background-position: 28px 0; }
}

.question-text {
    font-size: 1.4rem;
    font-weight: 700;
    margin-bottom: 2rem;
    min-height: 3.5rem;
}

.options-grid {
    display: grid;
    gap: 15px;
    width: 100%;
}

.option-btn {
    padding: 15px;
    background: white;
    border: 2px solid #b2bec3;
    border-radius: 10px;
    font-weight: 600;
    text-align: left;
    transition: all 0.2s;
    cursor: none;
}
.option-btn:hover { border-color: var(--ink-color); transform: scale(1.02) rotate(-1deg); background: #fffdf0; }
.option-btn.correct { background: var(--accent-green); border-color: var(--ink-color); color: var(--ink-color); box-shadow: 4px 4px 0 var(--ink-color); }

/* --- DYNAMIC POLAROID REVEAL (Updated Image Size) --- */
/* --- DYNAMIC POLAROID REVEAL (Self-Adjusting) --- */
.polaroid-wrapper {
    margin-top: 25px;
    position: relative;
    width: 100%;
    display: none; 
    justify-content: center;
    align-items: center;
    opacity: 0;
    transition: opacity 0.5s ease;
}

.polaroid-wrapper.visible {
    display: flex;
    opacity: 1;
    animation: swingIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.polaroid {
    background: white;
    padding: 15px 15px 50px 15px; /* Bottom padding for caption */
    box-shadow: 5px 5px 15px rgba(0,0,0,0.15);
    border: 2px solid var(--ink-color);
    transform: rotate(-3deg);
    
    /* DYNAMIC SIZING MAGIC */
    display: inline-flex;       /* Shrink-wraps the container around content */
    flex-direction: column;
    width: fit-content;         /* Forces width to match image exactly */
    height: fit-content;
    box-sizing: border-box;
}

.polaroid img {
    display: block;
    /* Allow natural size but prevent screen overflow */
    width: auto;
    height: auto;
    max-width: 100%;            /* Don't overflow width */
    max-height: 40vh;           /* Cap height so it fits on mobile screens */
    
    object-fit: contain;
    border: 2px solid var(--ink-color);
}

.tape {
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 30px;
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(0,0,0,0.1);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    z-index: 2;
}

.feedback-text {
    font-family: 'Gloria Hallelujah', cursive;
    color: var(--ink-color);
    margin-top: 15px;
    font-size: 1.1rem;
    text-align: center;
    line-height: 1.4;
    word-wrap: break-word;
    max-width: 300px; /* Prevents text from stretching a very narrow image too wide */
}

@keyframes swingIn {
    0% { transform: translateY(50px) rotate(15deg); opacity: 0; }
    100% { transform: translateY(0) rotate(0deg); opacity: 1; }
}

/* --- CINEMATIC FINAL CARD --- */
#card-final {
    background: var(--paper-color);
    overflow: hidden;
}

.final-msg p {
    margin-bottom: 1.5rem;
    font-size: 1.2rem;
    line-height: 1.6;
    opacity: 0;
    transform: translateY(30px) scale(0.9);
    filter: blur(10px);
    transition: all 1s cubic-bezier(0.22, 1, 0.36, 1);
}

.final-msg p.show {
    opacity: 1;
    transform: translateY(0) scale(1);
    filter: blur(0px);
}

.spotlight {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 0vw;
    height: 0vw;
    background: radial-gradient(circle, rgba(255,234,167,0.3) 0%, rgba(244,248,251,0) 70%);
    border-radius: 50%;
    z-index: -1;
    transition: width 2s ease, height 2s ease;
}

.card.active .spotlight {
    width: 150vw;
    height: 150vw;
}

.star-burst {
    position: absolute;
    pointer-events: none;
    z-index: 50;
    font-size: 40px;
    animation: burst 1s forwards ease-out;
}

@keyframes burst {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
    100% { transform: translate(var(--tx), var(--ty)) rotate(var(--tr)) scale(1.5); opacity: 0; }
}

/* --- UTILITIES --- */
@media (max-width: 600px) {
    .card { padding: 1.5rem; }
    h1 { font-size: 2rem; }
    .countdown-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
    #cursor-dot, #cursor-glow { display: none; }
    body { cursor: auto; }
    .btn-quirky, .option-btn { cursor: pointer; }
    .polaroid { transform: rotate(-1deg); } 
}
</style>
</head>
<body>

<svg class="svg-filters">
    <filter id="wavy">
        <feTurbulence type="fractalNoise" baseFrequency="0.01" numOctaves="5" result="noise" />
        <feDisplacementMap in="SourceGraphic" in2="noise" scale="3" />
    </filter>
</svg>

<div id="cursor-dot"></div>
<div id="cursor-glow"></div>

<div class="bg-layer paper-grain"></div>

<div class="bg-layer bg-grid" id="bgGrid"></div>

<div class="bg-layer" id="doodles-container"></div>

<div class="bg-layer birthday-bg" id="birthdayBg"></div>


<div class="card-wrapper">
    
    <div class="watcher">
        <div class="eye"><div class="pupil"></div></div>
        <div class="eye"><div class="pupil"></div></div>
    </div>

    <div class="card active" id="card-countdown">
        <h1>A Very <span class="highlight">Cringy</span> message awaits</h1>
        <p id="countdownMsg">Shutup and wait for it...</p>

        <div class="countdown-grid">
            <div class="time-box"><span id="d">0</span><small>DAYS</small></div>
            <div class="time-box"><span id="h">0</span><small>HRS</small></div>
            <div class="time-box"><span id="m">0</span><small>MIN</small></div>
            <div class="time-box"><span id="s">0</span><small>SEC</small></div>
        </div>

        <button id="unlockBtn" class="btn-quirky disabled">Wait for it....‚è±Ô∏è</button>
    </div>

    <div class="card" id="card-game">
        <div class="progress-track"><div class="progress-fill" id="progressBar"></div></div>
        <div class="question-text" id="question">Loading...</div>
        
        <div class="options-grid" id="options"></div>

        <div class="polaroid-wrapper" id="answerReveal">
            <div class="polaroid">
                <div class="tape"></div>
                <img id="revealImg" src="" alt="Memory">
                <div class="feedback-text" id="feedback"></div>
            </div>
        </div>
    </div>

    <div class="card" id="card-final">
        <div class="spotlight"></div>
        <h1 style="margin-top: 20px;">Happy Birthday! üéÇ</h1>
        <div class="final-msg">
            <p>You're the reason I believe in companionship üíñ</p>
            <p>Every moment with you feels like a peaceful dream... üå∏</p>
            <p>You're not just someone I love, you're my peace and my best friend üåπ</p>
            <p>No matter how much you test my patience, I'd still choose you every single time üí´</p>
            <p style="font-family: 'Gloria Hallelujah'; font-size: 1.6rem; color: var(--accent-pink); margin-top: 30px; font-weight: bold;">
                I love you today, tomorrow, and always üíñ
            </p>
        </div>
    </div>
</div>

<script>
/* --- BIRTHDAY BACKGROUND GENERATOR --- */
(function createBirthdayBackground() {
    const container = document.getElementById('birthdayBg');
    const COUNT = 18;

    const assets = [
        {
            type: 'bday-ribbon',
            svg: `<svg viewBox="0 0 100 50"><path d="M0 25 Q25 0 50 25 T100 25"/></svg>`
        },
        {
            type: 'bday-balloon',
            svg: `<svg viewBox="0 0 60 80"><ellipse cx="30" cy="30" rx="20" ry="25"/><line x1="30" y1="55" x2="30" y2="80"/></svg>`
        },
        {
            type: 'bday-spark',
            svg: `<svg viewBox="0 0 40 40"><line x1="20" y1="0" x2="20" y2="40"/><line x1="0" y1="20" x2="40" y2="20"/></svg>`
        }
    ];

    for (let i = 0; i < COUNT; i++) {
        const shape = document.createElement('div');
        const asset = assets[Math.floor(Math.random() * assets.length)];

        shape.className = `bday-shape ${asset.type}`;
        shape.innerHTML = asset.svg;

        const size = Math.random() * 60 + 40;
        shape.style.width = size + 'px';
        shape.style.height = size + 'px';
        shape.style.left = Math.random() * 100 + 'vw';
        shape.style.animationDuration = (Math.random() * 20 + 18) + 's';
        shape.style.animationDelay = (-Math.random() * 20) + 's';

        container.appendChild(shape);
    }
})();

function goFullscreen() {
    const el = document.documentElement;

    if (el.requestFullscreen) {
        el.requestFullscreen();
    } else if (el.webkitRequestFullscreen) {
        el.webkitRequestFullscreen(); // Safari
    } else if (el.msRequestFullscreen) {
        el.msRequestFullscreen(); // IE11
    }
}


/* --- CONFIG --- */
const countdownMsg = document.getElementById('countdownMsg');
const targetDate = new Date(2026, 0, 11, 0, 0, 0); 
const questions = [
    {
        q: "What's my secret favorite thing you do without realizing? üëÄ‚ú®",
        a: ["That little hum you do when you're lost in your own world üé∂", "Your judgy side eyes üòí"],
        correctIndex: 0, 
        f: "All these little moments of you being unguarded are my most precious treasures üíï",
        img: "1.jpeg"
    },
    {
        q: "What do I admire the most about you? üëë",
        a: ["How strongüí™, independent, and fearless you are while still loving your people deeply ‚ù§Ô∏è", "How you pretend not to care üòå"],
        correctIndex: 0,
        f: "STRONG. INDEPENDENT. WOMEN!! Your strength inspires me every single day, even when you pretend you don‚Äôt need me üíñ",
        img: "5.jpeg"
    },
    {
        q: "My favorite way to see you happy? ‚ú®",
        a: ["Good foodüçï + Good moodüòÑ, and that beautiful smile I‚Äôm always obsessed with", "Giving you 10Cr üí∞üòè"],
        correctIndex: 0,
        f: "Food + Your Smile = My Happiness. (Also I'm broke so no 10Cr) üíù",
        img: "2.jpeg"
    },
    {
        q: "Why do I choose you even when you're annoying? üòÖ",
        a: ["Your attitude, your honesty, and that gorgeous smile you act like I exaggerate about üòå", "The way you hate me sometimes‚Ä¶ but still like me üòÑ"],
        correctIndex: 0,
        f: "Even when you drive me crazy, choosing you is easy. üíó",
        img: "3.jpeg"
    },
    {
        q: "Where are you in my future? üåç",
        a: ["Right beside me, always üíï", "I don't want to be with you!!üòí"],
        correctIndex: 0,
        f: "I want to walk every path with you. üíñ",
        img: "4.jpeg"
    }
];

/* --- ELEMENTS --- */
const cursorDot = document.getElementById('cursor-dot');
const cursorGlow = document.getElementById('cursor-glow');
const pupils = document.querySelectorAll('.pupil');
const unlockBtn = document.getElementById('unlockBtn');
const bgGrid = document.getElementById('bgGrid');

/* --- 1. SMOOTH CURSOR & TRACKING --- */
let mouseX = window.innerWidth / 2;
let mouseY = window.innerHeight / 2;
let cursorX = mouseX, cursorY = mouseY;

document.addEventListener('mousemove', (e) => {
    mouseX = e.clientX;
    mouseY = e.clientY;
});
document.addEventListener('mousedown', () => document.body.classList.add('is-clicking'));
document.addEventListener('mouseup', () => document.body.classList.remove('is-clicking'));

// Initialize Background Grid
function initGrid() {
    // Determine how many cells fit
    const cols = Math.ceil(window.innerWidth / 100);
    const rows = Math.ceil(window.innerHeight / 100);
    const total = cols * rows;
    
    bgGrid.innerHTML = '';
    
    for(let i=0; i<total; i++) {
        const cell = document.createElement('div');
        cell.className = 'grid-item';
        // Create an arrow
        const arrow = document.createElement('div');
        arrow.className = 'grid-arrow';
        cell.appendChild(arrow);
        bgGrid.appendChild(cell);
    }
}
initGrid();
window.addEventListener('resize', initGrid);

function animateCursor() {
    const speed = 0.15;
    cursorX += (mouseX - cursorX) * speed;
    cursorY += (mouseY - cursorY) * speed;

    cursorDot.style.left = `${mouseX}px`;
    cursorDot.style.top = `${mouseY}px`;
    cursorGlow.style.left = `${cursorX}px`;
    cursorGlow.style.top = `${cursorY}px`;

    // Watcher Eyes
    pupils.forEach(pupil => {
        const rect = pupil.parentElement.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        const angle = Math.atan2(mouseY - centerY, mouseX - centerX);
        const distance = Math.min(10, Math.hypot(mouseX - centerX, mouseY - centerY) / 10);
        pupil.style.transform = `translate(-50%, -50%) translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`;
    });

    // Background Grid Arrows
    const arrows = document.querySelectorAll('.grid-arrow');
    arrows.forEach(arrow => {
        const rect = arrow.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        // Calculate angle to mouse
        const angleRad = Math.atan2(mouseY - centerY, mouseX - centerX);
        // Add 135deg because CSS arrow is built using border-right/bottom
        const angleDeg = (angleRad * 180 / Math.PI) - 45; 
        arrow.style.transform = `rotate(${angleDeg}deg)`;
    });

    requestAnimationFrame(animateCursor);
}
animateCursor();

/* --- 2. DOODLE GENERATOR --- */
function createDoodles() {
    const container = document.getElementById('doodles-container');
    const colors = ['var(--accent-pink)', 'var(--accent-teal)', 'var(--accent-purple)', 'var(--accent-yellow)'];
    const svgs = [
        `<path d="M10,10 Q30,5 50,10 T90,10" />`,
        `<circle cx="10" cy="10" r="8" />`,
        `<polygon points="10,0 20,20 0,20" />`,
        `<path d="M10,0 L13,7 L20,7 L15,12 L17,19 L10,15 L3,19 L5,12 L0,7 L7,7 Z" />`
    ];

    for (let i = 0; i < 20; i++) { // Increased count
        const div = document.createElement('div');
        div.className = 'shape';
        div.style.left = Math.random() * 100 + 'vw';
        div.style.top = Math.random() * 100 + 'vh';
        div.style.width = (Math.random() * 30 + 15) + 'px';
        div.style.height = div.style.width;
        div.style.setProperty('--color', colors[Math.floor(Math.random() * colors.length)]);
        div.style.setProperty('--duration', (Math.random() * 10 + 10) + 's');
        div.style.setProperty('--mx', (Math.random() * 100 - 50) + 'px');
        div.style.setProperty('--my', (Math.random() * 100 - 50) + 'px');
        div.style.setProperty('--mr', (Math.random() * 360) + 'deg');
        div.innerHTML = `<svg viewBox="0 0 30 30" style="overflow:visible">${svgs[Math.floor(Math.random() * svgs.length)]}</svg>`;
        container.appendChild(div);
    }
}
createDoodles();

/* --- 3. COUNTDOWN --- */
function updateTimer() {
    const now = new Date();
    const diff = targetDate - now;

    if (diff <= 0) {
        document.getElementById('d').innerText = "0";
        document.getElementById('h').innerText = "0";
        document.getElementById('m').innerText = "0";
        document.getElementById('s').innerText = "0";

        // üîì Unlock state (runs once, safely)
        if(unlockBtn.classList.contains('disabled')) {
            unlockBtn.classList.remove('disabled');
            unlockBtn.innerText = "‚ú® Unlock Surprise! ‚ú®";
            countdownMsg.innerText = "Let the suffering begin üòà";
        }
        return;
    }

    // üîí Locked state (enforced every tick)
    if(!unlockBtn.classList.contains('disabled')) {
        unlockBtn.classList.add('disabled');
    }
    unlockBtn.innerText = "Wait for it....‚è±Ô∏è";
    countdownMsg.innerText = "Shutup and wait for it...";

    document.getElementById('d').innerText = Math.floor(diff / (1000 * 60 * 60 * 24));
    document.getElementById('h').innerText = Math.floor((diff / (1000 * 60 * 60)) % 24);
    document.getElementById('m').innerText = Math.floor((diff / 1000 / 60) % 60);
    document.getElementById('s').innerText = Math.floor((diff / 1000) % 60);
}


setInterval(updateTimer, 1000);
updateTimer();

/* --- 3b. BUTTON CLICK LOGIC (Shake/Unlock) --- */
unlockBtn.addEventListener('click', (e) => {
    // If disabled, trigger shake animation
    if(unlockBtn.classList.contains('disabled')) {
        unlockBtn.classList.remove('shake-anim');
        void unlockBtn.offsetWidth; // Force reflow
        unlockBtn.classList.add('shake-anim');
    } 
    // If unlocked, proceed
    else {
        goFullscreen();
        startQuiz();
    }
});


/* --- 4. NAVIGATION --- */
function switchCard(hideId, showId) {
    const hideEl = document.getElementById(hideId);
    const showEl = document.getElementById(showId);
    hideEl.classList.add('exit');
    hideEl.classList.remove('active');
    setTimeout(() => {
        hideEl.style.display = 'none';
        showEl.style.display = 'flex';
        void showEl.offsetWidth; 
        showEl.classList.add('active');
        hideEl.classList.remove('exit');
    }, 500);
}

/* --- 5. QUIZ LOGIC --- */
let qIndex = 0;

function startQuiz() {
    switchCard('card-countdown', 'card-game');
    loadQuestion();
}

function loadQuestion() {
    const q = questions[qIndex];
    document.getElementById('question').innerText = q.q;
    const optContainer = document.getElementById('options');
    optContainer.innerHTML = '';
    
    // Hide reveal wrapper, show options
    const revealWrapper = document.getElementById('answerReveal');
    revealWrapper.classList.remove('visible');
    revealWrapper.style.display = 'none'; 
    optContainer.style.display = 'grid';

    // Updated Progress calculation to show progress immediately
    const progressPercent = ((qIndex + 1) / questions.length) * 100;
    document.getElementById('progressBar').style.width = progressPercent + '%';

    q.a.forEach((ans, idx) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerText = ans;
        btn.onclick = () => handleAnswer(idx, btn);
        optContainer.appendChild(btn);
    });
}

function handleAnswer(idx, btnEl) {
    const allBtns = document.querySelectorAll('.option-btn');
    allBtns.forEach(b => b.style.pointerEvents = 'none');
    
    btnEl.classList.add('correct');
    createParticles(btnEl.getBoundingClientRect());

    const q = questions[qIndex];
    const revealWrapper = document.getElementById('answerReveal');
    const img = document.getElementById('revealImg');
    const feed = document.getElementById('feedback');
    const optionsGrid = document.getElementById('options');

    feed.innerText = q.f;
    
    img.onload = function() {
        optionsGrid.style.display = 'none';
        // Now that image has loaded dimensions, the wrapper can calculate size
        revealWrapper.style.display = 'flex'; 
        setTimeout(() => {
             revealWrapper.classList.add('visible'); 
        }, 10);
    };

    img.onerror = function() {
        this.src = 'data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22200%22%20height%3D%22200%22%20viewBox%3D%220%200%20200%20200%22%3E%3Crect%20fill%3D%22%23ffeaa7%22%20width%3D%22200%22%20height%3D%22200%22%2F%3E%3Ctext%20x%3D%2250%25%22%20y%3D%2250%25%22%20font-family%3D%22sans-serif%22%20font-size%3D%2220%22%20text-anchor%3D%22middle%22%20fill%3D%22%232d3436%22%3EMemory%20Loading...%3C%2Ftext%3E%3C%2Fsvg%3E';
    };

    img.src = q.img;
    
    setTimeout(() => {
        revealWrapper.classList.remove('visible');
        setTimeout(() => {
            qIndex++;
            if(qIndex < questions.length) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        }, 500);
    }, 5000); 
}

function finishQuiz() {
    switchCard('card-game', 'card-final');
    document.getElementById('progressBar').style.width = '100%';
    
    // 1. Cinematic Explosion
    const burstCount = 20;
    for(let i=0; i<burstCount; i++) {
        setTimeout(() => {
            const star = document.createElement('div');
            star.className = 'star-burst';
            star.innerHTML = ['‚ú®','‚≠ê','üíñ','üå∏','üé®'][Math.floor(Math.random()*5)];
            star.style.left = '50%';
            star.style.top = '50%';
            star.style.setProperty('--tx', (Math.random() * 400 - 200) + 'px');
            star.style.setProperty('--ty', (Math.random() * 400 - 200) + 'px');
            star.style.setProperty('--tr', (Math.random() * 360) + 'deg');
            document.getElementById('card-final').appendChild(star);
            setTimeout(() => star.remove(), 1000);
        }, i * 50);
    }

    // 2. Text Reveal
    const lines = document.querySelectorAll('.final-msg p');
    lines.forEach((line, i) => {
        setTimeout(() => {
            line.classList.add('show');
            createParticles(line.getBoundingClientRect());
        }, i * 1800 + 1000);
    });

    // 3. Heart Rain
    setInterval(() => {
        const heart = document.createElement('div');
        heart.innerHTML = '‚ù§Ô∏è';
        heart.style.position = 'fixed';
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.bottom = '-20px';
        heart.style.fontSize = (Math.random() * 20 + 10) + 'px';
        heart.style.opacity = Math.random();
        heart.style.pointerEvents = 'none';
        heart.style.zIndex = '10';
        document.body.appendChild(heart);

        heart.animate([
            { transform: 'translateY(0) rotate(0deg)', opacity: heart.style.opacity },
            { transform: `translateY(-110vh) rotate(${Math.random() * 360}deg)`, opacity: 0 }
        ], {
            duration: Math.random() * 3000 + 4000,
            easing: 'linear'
        }).onfinish = () => heart.remove();
    }, 400);
}

/* --- 6. PARTICLES --- */
function createParticles(rect) {
    const count = 15;
    const colors = ['#fdcb6e', '#ff7675', '#74b9ff', '#55efc4', '#a29bfe'];
    
    for(let i=0; i<count; i++) {
        const p = document.createElement('div');
        p.style.position = 'fixed';
        p.style.left = (rect.left + rect.width/2) + 'px';
        p.style.top = (rect.top + rect.height/2) + 'px';
        p.style.width = (Math.random() * 8 + 4) + 'px';
        p.style.height = p.style.width;
        p.style.background = colors[Math.floor(Math.random() * colors.length)];
        p.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
        p.style.pointerEvents = 'none';
        p.style.zIndex = '9999';
        document.body.appendChild(p);
        
        const angle = Math.random() * Math.PI * 2;
        const velocity = Math.random() * 100 + 50;
        const tx = Math.cos(angle) * velocity;
        const ty = Math.sin(angle) * velocity;
        
        p.animate([
            { transform: 'translate(0,0) scale(1)', opacity: 1 },
            { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
        ], {
            duration: 800 + Math.random() * 400,
            easing: 'cubic-bezier(0, .9, .57, 1)'
        }).onfinish = () => p.remove();
    }
}
</script>
</body>

</html>

